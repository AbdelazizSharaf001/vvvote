<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>protocol</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="welcome-to-vvvote">Welcome to VVVote!</h1>

<p>Short Explanation of the VVVote Protocol</p>



<h2 id="table-of-content">Table of Content</h2>

<p><div class="toc">
<ul>
<li><a href="#welcome-to-vvvote">Welcome to VVVote!</a><ul>
<li><a href="#table-of-content">Table of Content</a></li>
<li><a href="#overview">Overview</a></li>
</ul>
</li>
<li><a href="#definitions">Definitions</a></li>
<li><a href="#phase-1-obtaining-the-return-envelope">Phase 1: Obtaining the Return Envelope</a><ul>
<li><a href="#the-general-idea">The General Idea</a></li>
<li><a href="#the-process-in-more-detail">The Process in More Detail</a></li>
</ul>
</li>
<li><a href="#phase-2-cast-the-vote">Phase 2: Cast the Vote</a></li>
<li><a href="#routine-to-prepare-return-envelops-in-the-client">Routine to Prepare Return Envelops in the Client</a></li>
<li><a href="#phase-3-publish-all-votes">Phase 3: Publish All Votes</a><ul>
<li><ul>
<li><a href="#support-stackedit">Support StackEdit</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</p>



<h2 id="overview">Overview</h2>

<p>vvvote protocol consists of three phases:</p>

<ol>
<li>obtaining an anonymous return envelope </li>
<li>using the anonymous return envelope in order to cast the vote</li>
<li>publish all votes </li>
</ol>

<p>The phases are fixed periods and publicly announced.</p>



<h1 id="definitions">Definitions</h1>

<p>voter <br>
    the computer of the voter (in the following just the called the voter)</p>



<h1 id="phase-1-obtaining-the-return-envelope">Phase 1: Obtaining the Return Envelope</h1>

<p>In the first phase, the voter identifies to the server and let the server sign an anonymous return envelope. This anonymous return envelope will be used in the voting phase to cast the vote. <br>
The return envelope consists mainly of an RSA public key which was signed blindly by the server. The server signature indicates that this is a valid key for signing a vote, e.g. the key pair belongs to an entitled voter.</p>

<blockquote>
  <p>Note: nobody except the voter himself can do a matching between the RSA key used to sign the vote and the individual voter. This is because the server signs the corresponding public key blindly, meaning it is encrypted by the voter beforehand and decrypted after the server had singed the voter’s anonymous public key. </p>
</blockquote>



<h2 id="the-general-idea">The General Idea</h2>

<p>In this phase the voter will obtain an RSA key which is signed blindly by the server indicating that it is allowed for signing the vote and thereby giving the right to vote. <br>
In order to achieve this, the voter, generates an RSA key pair. Then the voter blinds the public part of it and sends it to the server, together with the voter’s credentials.  <br>
The server checks the credentials and weather it’s the first request of this vote for a return envelope. If everything is ok, the server signs the blinded public key and sends it back to the voter.</p>



<h2 id="the-process-in-more-detail">The Process in More Detail</h2>

<p>Two problems are additionally addressed:</p>

<ol>
<li>avoid the necessity to trust a single server <br>
In order to add some more resistance against manipulation attacks to the server, we added a second server which does mainly the same as the first one and also verifies if the first server was acting correctly. </li>
<li>do not rely blindly on the client program to function correctly <br>
In order to be able to verify if the client program is working correctly, it must produce 5 RSA key pairs and individual blinding factors. Each server will ask randomly for some of them for the unblinding factors so that the servers can verify if the client knows the corresponding unblind factor, the private RSA key and has done the procedures correctly.</li>
</ol>

<p>Putting these things togehter, we get the following protocol:</p>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.25px; top: -0.666748px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1149.8666553497314" version="1.1" height="1495.999984741211"><desc>Created with Raphaël 2.1.2</desc><defs><path id="raphael-marker-block" d="M5,0 0,2.5 5,5z" stroke-linecap="round"></path><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj51"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj60"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj63"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj72"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj78"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj87"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj93"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj105"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="55.13333511352539" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="35.13333511352539" y="30" x="20.016666412353516"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="37.566667556762695" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Voter</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="55.13333511352539" y="1435.999984741211" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="35.13333511352539" y="1446" x="20.016666412353516"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1455.999984741211" x="37.566667556762695" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.9999847412109375">Voter</tspan></text><path stroke-width="2" d="M37.566667556762695,60L37.566667556762695,1435.999984741211" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="75.83333206176758" y="20" x="500.19998931884766"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="55.83333206176758" y="30" x="510.0749816894531"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="538.1166553497314" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Server_1</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="75.83333206176758" y="1435.999984741211" x="500.19998931884766"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="55.83333206176758" y="1446" x="510.0749816894531"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1455.999984741211" x="538.1166553497314" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.9999847412109375">Server_1</tspan></text><path stroke-width="2" d="M538.1166553497314,60L538.1166553497314,1435.999984741211" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="76" y="20" x="1043.8666553497314"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="56" y="30" x="1053.8250732421875"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="1081.8666553497314" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Server_2</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="76" y="1435.999984741211" x="1043.8666553497314"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="56" y="1446" x="1053.8250732421875"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1455.999984741211" x="1081.8666553497314" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.9999847412109375">Server_2</tspan></text><path stroke-width="2" d="M1081.8666553497314,60L1081.8666553497314,1435.999984741211" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="97.19999694824219" width="357.6499938964844" y="80" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="87.19999694824219" width="347.64996337890625" y="85" x="62.82499694824219"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="128.5999984741211" x="236.39166450500488" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-28.600006103515625">subroutine: "Generate Return Envelops" </tspan><tspan x="236.39166450500488" dy="16.8">generates </tspan><tspan x="236.39166450500488" dy="16.8"> - 5 RSA key pairs and </tspan><tspan x="236.39166450500488" dy="16.8"> - 5 corresponding blinding factors</tspan><tspan x="236.39166450500488" dy="16.8"> - blinded hashes of the public parts of the RSA key pairs</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.80000305175781" width="352.7833251953125" y="183.79998779296875" x="111.45000457763672"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="202.1999969482422" x="287.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.4000015258789062">(1) I am Bob, my password is &lt;secret&gt;,</tspan><tspan x="287.84166145324707" dy="16.8"> the blinded hashes of the 5 public keys I generated are []</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj51)" stroke-width="2" d="M37.566667556762695,233.99999618530273C37.566667556762695,233.99999618530273,480.9468971694114,233.99999618530273,533.1220120798843,233.99999618530273" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="185.76666259765625" y="253.99999618530273" x="332.3499927520752"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.79998779296875" width="175.76666259765625" y="259" x="337.48333740234375"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="277.399995803833" x="425.2333240509033" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.399991989135742">- verify password,</tspan><tspan x="425.2333240509033" dy="16.8"> - is first request for a ballot?</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="261.03334045410156" y="320.7999954223633" x="257.0833148956299"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.800018310546875" width="251.0333251953125" y="325.79998779296875" x="262.191650390625"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="344.19999504089355" x="387.59998512268066" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.3999805450439453">randomly select 3 of the generated keys,</tspan><tspan x="387.59998512268066" dy="16.8"> e.g. key numbers 1, 3 and 4</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.79998779296875" width="380.0333251953125" y="374.20001220703125" x="98.03334045410156"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="392.5999946594238" x="287.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.400005340576172">(2) Send me the unblinding factors of hashes 1,3 and 4</tspan><tspan x="287.84166145324707" dy="16.8">as well as all the data belonging to the corresponding hashes</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj60)" stroke-width="2" d="M538.1166553497314,424.3999938964844C538.1166553497314,424.3999938964844,94.73642573708275,424.3999938964844,42.56131082660993,424.3999938964844" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="225.5833282470703" y="439.3999938964844" x="175.0500030517578"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="449.3999938964844" x="287.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">(3) (str, unblindFactor)[1], [3] and [4]</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj63)" stroke-width="2" d="M37.566667556762695,464.3999938964844C37.566667556762695,464.3999938964844,480.9468971694114,464.3999938964844,533.1220120798843,464.3999938964844" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="97.19999694824219" width="398.54998779296875" y="484.3999938964844" x="119.5666675567627"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="87.19998168945312" width="388.5499572753906" y="489.3999938964844" x="124.67501068115234"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="532.9999923706055" x="318.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-28.600013732910156">verify if voter has done everything correctly:</tspan><tspan x="318.84166145324707" dy="16.8"> - unblind the hashes 1, 3 and 4 sent in (1),</tspan><tspan x="318.84166145324707" dy="16.8"> - verify if they match the corresponding hashes of str,</tspan><tspan x="318.84166145324707" dy="16.8"> - verify that the public key contained in str is not used already,</tspan><tspan x="318.84166145324707" dy="16.8"> - verify electionId</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="418.6666564941406" y="601.5999908447266" x="99.44999885559082"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.800048828125" width="408.6666564941406" y="606.5999755859375" x="104.44998931884766"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="624.9999904632568" x="308.78332710266113" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.400003433227539">randomly select 2 still blinded hashes (e.g. 2 and 5) and sign them</tspan><tspan x="308.78332710266113" dy="16.8"> BlindServer_1Sigs={Sign blindedHash[2], Sign blindedHash[5]}</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="133.4499969482422" y="663.3999633789062" x="221.37501525878906"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="673.3999900817871" x="287.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000026702880859">(4) BlindServer_1Sigs</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj72)" stroke-width="2" d="M538.1166553497314,688.3999900817871C538.1166553497314,688.3999900817871,94.73642573708275,688.3999900817871,42.56131082660993,688.3999900817871" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="268.3833312988281" y="708.3999900817871" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="258.3833312988281" y="713.3999633789062" x="62.45833206176758"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="723.3999900817871" x="191.75833320617676" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000026702880859">Verify if the BlindServer_1Sigs are correct</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.79998779296875" width="236.7166748046875" y="745" x="441.4666748046875"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="763.3999900817871" x="559.7166614532471" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.3999671936035156">(5) I am Bob, my password is &lt;secret&gt;,</tspan><tspan x="559.7166614532471" dy="16.8"> the BlindServer_1Sigs are []</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj78)" stroke-width="2" d="M37.566667556762695,795.1999893188477C37.566667556762695,795.1999893188477,998.93647298,795.1999893188477,1076.8600021305162,795.1999893188477" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="269.8333435058594" y="815.1999893188477" x="792.0333118438721"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.79998779296875" width="259.83331298828125" y="820.2000122070312" x="797.1666870117188"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="838.5999889373779" x="926.9499835968018" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.3999805450439453">- verify password,</tspan><tspan x="926.9499835968018" dy="16.8"> - is first request for a ballot at this server?</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="356.70001220703125" y="881.9999885559082" x="705.1666431427002"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="346.70001220703125" y="887" x="710.1749877929688"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="896.9999885559082" x="883.5166492462158" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999988555908203">randomly select 1 one of the 2 BlindServer_1Sigs, e.g. 2.</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="366.6499938964844" y="927" x="376.3999938964844"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="936.9999885559082" x="559.7166614532471" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999988555908203">(6) send me the unblindig factor for BlindServer_1Sig no. 2.</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj87)" stroke-width="2" d="M1081.8666553497314,951.9999885559082C1081.8666553497314,951.9999885559082,120.49684992649418,951.9999885559082,42.57332077597788,951.9999885559082" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="276.3166809082031" y="971.9999885559082" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="266.3166809082031" y="977" x="62.76667404174805"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="986.9999885559082" x="195.72500801086426" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999988555908203">Server_1Sig no. 2 = unblind BlindServerSig</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="184.56666564941406" y="1017" x="467.5916748046875"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1026.9999885559082" x="559.7166614532471" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999988555908203">(7) str, unblind factor for no. 2</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj93)" stroke-width="2" d="M37.566667556762695,1041.9999885559082C37.566667556762695,1041.9999885559082,998.93647298,1041.9999885559082,1076.8600021305162,1041.9999885559082" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="97.19999694824219" width="398.54998779296875" y="1061.9999885559082" x="663.3166675567627"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="87.199951171875" width="388.54998779296875" y="1067" x="668.4249877929688"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1110.5999870300293" x="862.5916614532471" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-28.599964141845703">verify if voter has done everything correctly:</tspan><tspan x="862.5916614532471" dy="16.8"> - unblind the hash of no. 2 sent in (5),</tspan><tspan x="862.5916614532471" dy="16.8"> - verify if they match the corresponding hashes of str,</tspan><tspan x="862.5916614532471" dy="16.8"> - verify that the public key contained in str is not used already,</tspan><tspan x="862.5916614532471" dy="16.8"> - verify electionId</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="503.75" y="1179.1999855041504" x="558.1166553497314"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="493.75" y="1184.199951171875" x="562.7833251953125"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1194.1999855041504" x="809.9916553497314" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000034332275391">verify if Server_1 has done everything correctly: verify the signature of Server_1</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="461.8500061035156" y="1229.1999855041504" x="600.0166492462158"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="451.8500061035156" y="1234.199951171875" x="604.7333374023438"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1244.1999855041504" x="830.9416522979736" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000034332275391">sign the left over still blind hash: BlindServer_2Sig = Sign blindedHash[5]</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="143.18333435058594" y="1274.199951171875" x="488.5249938964844"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1284.1999855041504" x="559.7166614532471" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000034332275391">(8) BlindedServer_2Sig</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj105)" stroke-width="2" d="M1081.8666553497314,1299.1999855041504C1081.8666553497314,1299.1999855041504,120.49684992649418,1299.1999855041504,42.57332077597788,1299.1999855041504" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="287.5" y="1319.1999855041504" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.800048828125" width="277.5" y="1324.199951171875" x="62.375"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1342.5999851226807" x="201.3166675567627" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.400014877319336">- Server_1Sig = unblind BlindServer_1Sigs[5]</tspan><tspan x="201.3166675567627" dy="16.8">  - Server_2Sig = unblind BlindServer_2Sig</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="460.54998779296875" y="1385.999984741211" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="450.54998779296875" y="1391" x="62.58333969116211"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="1400.999984741211" x="287.84166145324707" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.9999847412109375">Save(private key, public key, Server_1Sig, Server_2Sig) = returnEnvelope</tspan></text></svg></div>



<h1 id="phase-2-cast-the-vote">Phase 2: Cast the Vote</h1>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.25px; top: -0.466553px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="695.6916751861572" version="1.1" height="570.3999977111816"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj144"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj156"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="55.13333511352539" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="35.13333511352539" y="30" x="20.016666412353516"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="37.566667556762695" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Voter</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="55.13333511352539" y="510.39999771118164" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="35.13333511352539" y="520.4000244140625" x="20.016666412353516"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="530.3999977111816" x="37.566667556762695" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999973297119141">Voter</tspan></text><path stroke-width="2" d="M37.566667556762695,60L37.566667556762695,510.39999771118164" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="61.81666564941406" y="20" x="603.8750095367432"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="41.81666564941406" y="30" x="614.2000122070312"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="634.7833423614502" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Server</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="61.81666564941406" y="510.39999771118164" x="603.8750095367432"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="41.81666564941406" y="520.4000244140625" x="614.2000122070312"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="530.3999977111816" x="634.7833423614502" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999973297119141">Server</tspan></text><path stroke-width="2" d="M634.7833423614502,60L634.7833423614502,510.39999771118164" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="137.9000015258789" y="80" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="127.9000015258789" y="85" x="62.7833366394043"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="95" x="126.51666831970215" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">load returnEnvelope</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="46.79999923706055" width="209.8000030517578" y="130" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="36.80000305175781" width="199.8000030517578" y="135" x="62.67500686645508"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="153.39999961853027" x="162.4666690826416" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-3.399995803833008">let the voter make his decisions,</tspan><tspan x="162.4666690826416" dy="16.8"> save the decisions in vote</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="577.2166748046875" y="191.8000030517578" x="47.70001983642578"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="201.79999923706055" x="336.17500495910645" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="4.999996185302734">singedVote = vote + sig(vote) + Server_1Sig(public key) + Server_2Sig(public key) + public key</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj144)" stroke-width="2" d="M37.566667556762695,216.79999923706055C37.566667556762695,216.79999923706055,572.214132102321,216.79999923706055,629.7774943739497,216.79999923706055" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="63.599998474121094" width="371.76666259765625" y="236.79999923706055" x="243.01667976379395"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="53.600006103515625" width="361.76666259765625" y="241.79998779296875" x="248.2333526611328"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="268.5999984741211" x="428.90001106262207" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-11.800010681152344">- verify ServerSigs,</tspan><tspan x="428.90001106262207" dy="16.8"> - verify sig(vote),</tspan><tspan x="428.90001106262207" dy="16.8"> - verify if the public key is used the first time to sign a vote</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="334.8833312988281" y="320.39999771118164" x="279.90001106262207"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="324.8833312988281" y="325.3999938964844" x="284.6166687011719"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="335.39999771118164" x="447.34167671203613" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000003814697266">serverSigned = sign signedVote [to be implemented]</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="258.23333740234375" y="370.39999771118164" x="356.55000495910645"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="248.23333740234375" y="375.3999938964844" x="361.2666931152344"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="385.39999771118164" x="485.6666736602783" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000003814697266">store serverSigned [to be implemented]</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="504.01666259765625" y="415.3999938964844" x="83.88335418701172"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="425.39999771118164" x="336.17500495910645" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000003814697266">serverSigned(signedVote) [to be implemented, right now only "accepted" is sent]</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj156)" stroke-width="2" d="M634.7833423614502,440.39999771118164C634.7833423614502,440.39999771118164,100.13587781589194,440.39999771118164,42.57251554426324,440.39999771118164" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="201.96665954589844" y="460.39999771118164" x="57.566667556762695"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="191.96665954589844" y="465.3999938964844" x="62.2833366394043"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="475.39999771118164" x="158.5499973297119" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.000003814697266">save serverSigned(signedVote)</tspan></text></svg></div>



<h1 id="routine-to-prepare-return-envelops-in-the-client">Routine to Prepare Return Envelops in the Client</h1>



<div class="flow-chart"><svg style="overflow: hidden; position: relative; top: -0.966797px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="751.433349609375" version="1.1" height="581.5999813079834"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="1.5" refX="1.5" orient="auto" markerWidth="3" markerHeight="3" id="raphael-marker-endblock33-obj170"><use stroke="none" fill="black" stroke-width="1.6667" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" xlink:href="#raphael-marker-block"></use></marker><marker refY="1.5" refX="1.5" orient="auto" markerWidth="3" markerHeight="3" id="raphael-marker-endblock33-obj171"><use stroke="none" fill="black" stroke-width="1.6667" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" xlink:href="#raphael-marker-block"></use></marker><marker refY="1.5" refX="1.5" orient="auto" markerWidth="3" markerHeight="3" id="raphael-marker-endblock33-obj172"><use stroke="none" fill="black" stroke-width="1.6667" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" xlink:href="#raphael-marker-block"></use></marker><marker refY="1.5" refX="1.5" orient="auto" markerWidth="3" markerHeight="3" id="raphael-marker-endblock33-obj173"><use stroke="none" fill="black" stroke-width="1.6667" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" xlink:href="#raphael-marker-block"></use></marker></defs><rect transform="matrix(1,0,0,1,285.2917,29.2)" id="st" class="flowchart" stroke-width="2" style="" stroke="#000000" fill="#ffffff" ry="20" rx="20" height="40" width="182.85000610351562" y="0" x="0"></rect><text transform="matrix(1,0,0,1,285.2917,29.2)" font-weight="normal" class="flowchartt" id="stt" fill="#000000" stroke="none" font-size="14px" font-family="sans-serif" text-anchor="start" y="20" x="10" style="text-anchor: start; font-family: sans-serif; font-size: 14px; font-weight: normal;"><tspan dy="5">Generate Return Envelops</tspan></text><rect transform="matrix(1,0,0,1,260.9,148.4)" id="opRSAgen" class="flowchart" stroke-width="2" style="" stroke="#000000" fill="#ffffff" ry="0" rx="0" height="40" width="231.63333129882812" y="0" x="0"></rect><text transform="matrix(1,0,0,1,260.9,148.4)" font-weight="normal" class="flowchartt" id="opRSAgent" fill="#000000" stroke="none" font-size="14px" font-family="sans-serif" text-anchor="start" y="20" x="10" style="text-anchor: start; font-family: sans-serif; font-size: 14px; font-weight: normal;"><tspan dy="5">keys[] = Generate 10 RSA key pairs</tspan></text><rect transform="matrix(1,0,0,1,179.5083,259.2)" id="opBlindFgen" class="flowchart" stroke-width="2" style="" stroke="#000000" fill="#ffffff" ry="0" rx="0" height="56.79999923706055" width="394.4166564941406" y="0" x="0"></rect><text transform="matrix(1,0,0,1,179.5083,259.2)" font-weight="normal" class="flowchartt" id="opBlindFgent" fill="#000000" stroke="none" font-size="14px" font-family="sans-serif" text-anchor="start" y="28.399999618530273" x="10" style="text-anchor: start; font-family: sans-serif; font-size: 14px; font-weight: normal;"><tspan dy="-3.3999977111816406">- blindf[] = Generate 10 blinding factors </tspan><tspan x="10" dy="16.8">- unblindf[] = compute the corresopnding unblinding factors</tspan></text><rect transform="matrix(1,0,0,1,218.3167,370)" id="opBallotGen" class="flowchart" stroke-width="2" style="" stroke="#000000" fill="#ffffff" ry="0" rx="0" height="90.39999389648438" width="316.79998779296875" y="0" x="0"></rect><text transform="matrix(1,0,0,1,218.3167,370)" font-weight="normal" class="flowchartt" id="opBallotGent" fill="#000000" stroke="none" font-size="14px" font-family="sans-serif" text-anchor="start" y="45.19999694824219" x="10" style="text-anchor: start; font-family: sans-serif; font-size: 14px; font-weight: normal;"><tspan dy="-20.199996948242188">For each RSA-key-pair:</tspan><tspan x="10" dy="16.8">- str = concanate electionId, RSA public key, salt</tspan><tspan x="10" dy="16.8">- hash = Hash it /sha256/</tspan><tspan x="10" dy="16.8">- blindedHash = blind the hash</tspan></text><rect transform="matrix(1,0,0,1,4,539.6)" id="e" class="flowchart" stroke-width="2" style="" stroke="#000000" fill="#ffffff" ry="20" rx="20" height="40" width="745.433349609375" y="0" x="0"></rect><text transform="matrix(1,0,0,1,4,539.6)" font-weight="normal" class="flowchartt" id="et" fill="#000000" stroke="none" font-size="14px" font-family="sans-serif" text-anchor="start" y="20" x="10" style="text-anchor: start; font-family: sans-serif; font-size: 14px; font-weight: normal;"><tspan dy="5">return returnEnvelops = array[object(keys[index], blindf[index], unblindf[index], str, hash, blindedHash) for each key]</tspan><tspan x="10" dy="16.8"></tspan></text><path font-weight="normal" font-family="sans-serif" marker-end="url(#raphael-marker-endblock33-obj170)" stroke-width="2" d="M376.7166748046875,69.19999694824219C376.7166748046875,69.19999694824219,376.7166748046875,130.9251410542056,376.7166748046875,145.39197170404077" stroke="#000000" fill="none" style="font-family: sans-serif; font-weight: normal;"></path><path font-weight="normal" font-family="sans-serif" marker-end="url(#raphael-marker-endblock33-obj171)" stroke-width="2" d="M376.7166748046875,188.39999389648438C376.7166748046875,188.39999389648438,376.7166748046875,242.72730546137063,376.7166748046875,256.20302532219205" stroke="#000000" fill="none" style="font-family: sans-serif; font-weight: normal;"></path><path font-weight="normal" font-family="sans-serif" marker-end="url(#raphael-marker-endblock33-obj172)" stroke-width="2" d="M376.7166748046875,315.99999046325684C376.7166748046875,315.99999046325684,376.7166748046875,355.6540904045105,376.7166748046875,367.0004295478575" stroke="#000000" fill="none" style="font-family: sans-serif; font-weight: normal;"></path><path font-weight="normal" font-family="sans-serif" marker-end="url(#raphael-marker-endblock33-obj173)" stroke-width="2" d="M376.7166748046875,460.3999843597412C376.7166748046875,460.3999843597412,376.7166748046875,522.1251284657046,376.7166748046875,536.5919591155398" stroke="#000000" fill="none" style="font-family: sans-serif; font-weight: normal;"></path></svg></div>



<h1 id="phase-3-publish-all-votes">Phase 3: Publish All Votes</h1>

<p>All Votes are published and can be obtained from the server in order to…</p>

<ul>
<li>verify that no vote was changed (e.g. on each vote the voter’s signature is valid)</li>
<li>verify that all votes come from legitimate voters (e.g. the server signature of the public key of each voter is valid)</li>
<li>verify that my vote is contained</li>
<li>tally the votes</li>
</ul>

<hr>

<blockquote>
  <p><strong>Note:</strong> You can find more information:</p>
  
  <ul>
  <li>about <strong>Sequence diagrams</strong> syntax <a href="http://bramp.github.io/js-sequence-diagrams/">here</a>,</li>
  <li>about <strong>Flow charts</strong> syntax <a href="http://adrai.github.io/flowchart.js/">here</a>.</li>
  </ul>
</blockquote>



<h3 id="support-stackedit">Support StackEdit</h3>

<p><a href="https://monetizejs.com/authorize?client_id=ESTHdCYOi18iLhhO&amp;summary=true"><img src="https://cdn.monetizejs.com/resources/button-32.png" alt="" title=""></a></p></div></body>
</html>